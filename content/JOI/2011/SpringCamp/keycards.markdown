---
layout: post
title: "JOI 春合宿 2011 Keycards"
date: 2014-09-26T04:21:00+09:00
comments: true
category: JOI
tags: [math]
---

[Keycards](http://joisc2011.contest.atcoder.jp/tasks/joisc2011_keycards)

#### 問題概要

****

n箇所のうちいくつかに穴を開けたカードがある.  
今そのようなカードをいくつか受け取る.  
このときどのカードもちょうどk箇所の同じ場所に穴が空いている.  
そのような組合せはいくつあるか.

#### 解法

****

まずk箇所を固定して考える(最後にその組合せ`$ _{n}C_{k} $`を掛ければよい).  
他の残りn-k箇所を考える.  
  
手に入れた全てのカードのn-k箇所のうち左からi箇所に穴が空いているとする.  
他のn-k-i箇所が取りうる場合の数(つまりそのようなカードキーの数)は`$2^{n-k-i}$`通り.  
そこからどれを選ぶかは`$2^{2^{n-k-i}}$`通り(i+1個以上穴が空く場合も含まれる).  
これからi+1箇所穴が空いてるとする場合の選び方を引いてやればi+1個穴が開いてる場合が消せるのでそれをi+1箇所の組合せでやる.  
これはi+2箇所やつ以降では余計に引かれている.  
さらにそれをi箇所の組合せ全てでやる.  
これをi=0から順にやっていけばよい  
  
例えば  
n=3, k=1の場合, 1が穴が空いているとすると  
i=0で  
00  
01  
10  
11  
から任意個選んだ場合の数  
i=1で  
10  
11  
から任意個選んだ場合の数を引けば1\*(\*はなんでもよい)となる場合を引ける.  
同様に  
01  
11  
の場合も引いてやると\*1となる場合を引ける.  
i=2で  
11  
から任意個選んだ場合を足せば前で引きすぎた11となる場合を消せる.  
  
以上を踏まえると以下の式で求めることができる(穴が0個の場合のみになるように足し引きする)  

<div> $ {\displaystyle

\sum_{i=0}^{n-k} (-1)^{i} _{n-k}C_{i} 2^{2^{n-k-i}}

} $</div>

2の冪の冪(2の(2のi乗)乗)は2, 4, 16, 256...となるので前計算しておく  
  
この方法だとn=kの場合は全て穴が空いてない場合を使えてしまうが, どうせ1なのでそのまま返す.  
またn=1のときはk=0の場合も使えてしまうがこれもどうせ0なのでそのまま返す.

#### コード

****

{{< includeCode "/JOI/2011/keycards.cpp" "cpp" >}}
