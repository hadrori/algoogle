---
layout: post
title: "JOI 春合宿 2011 Apples"
date: 2014-09-30T23:29:00+09:00
comments: true
category: JOI
tags: [segment-tree]
---

[Apples](http://joisc2011.contest.atcoder.jp/tasks/joisc2011_apples)

#### 問題概要

****

M(<=100,000)個のクエリを処理する.  

* クエリA: 濃さD\[i\](<=1,000,000,000)のリンゴを1つ入荷する

* クエリR: リンゴをN\[i\](<=100,000)個, その全ての組の濃さの差がB(<=1,000,000,000)以内になるようなもののうち濃さの総和が最大になるようなものを出荷する

#### 解法

****

各リンゴの濃さに対してその後ろに幅Bの区間を考える.  
その区間が重なる数をみると, 濃さのバラつきがB以内となるものの数がわかる.  
これを各区間での最大値をもち, 区間に値を加えるsegment-treeで考えれば良い.  
N\[i\]以上になる一番濃い場所を探すには各区間での最大値をもち, 条件を満たすようなものを右側優先に潜っていけばよい.  
  
問題では濃さの値が大きいが入荷するリンゴは高々10^5個, つまり濃さの種類は高々10^5.  
segment-treeの各ノードを全て持つと当然まずいので必要になったら作る感じでやる.

#### コード

****

{{< includeCode "/JOI/2011/apples.cpp" "cpp" >}}
