---
layout: post
title: "JOI 春合宿 2008 Belt"
date: 2014-09-04T03:10:00+09:00
comments: true
category: JOI
tags: [geometory]
---

[Belt](http://joisc2008.contest.atcoder.jp/tasks/joisc2008_belt)

#### 問題概要

****

平面上に直線を引いたときに, その直線から距離d以内に存在する点の数を最大化しろ

#### 解法

****

1点を固定して中心と考える.  
その点を通る直線から左右どちらかに幅2dをとって360度回してやって, 各イベント点でいくつ中に入ってきてるかカウントしてやれば良い.  
  
はじめ帯がx軸から上に幅2dとった状態からスタートするとする.  
イベントは点が帯に入るときと出るときで, 点の偏角をth, 原点からの距離をrとすると  


* th-asin(d/r) : 帯に入る  
* th : 帯から出る
* th+pi : 帯に入る
* th+pi+asin(d/r) : 帯から出る

の4つが考えられる.  
またrがd以下の場合帯から出られない部分があるので


* th+pi : 帯に入る
* th : 帯から出る

の2つだけになる.  
あとははじめから帯に入っている場合に注意してイベント(偏角)順にソートして順番に見ていけばよい


#### コード

****

{{< includeCode "/JOI/2008/Belt.cpp" "cpp" >}}
