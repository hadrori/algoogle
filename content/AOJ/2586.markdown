---
layout: post
title: "AOJ 2586 Wish upon a shooting star"
date: 2014-08-15T04:06:00+09:00
comments: true
category: AOJ
tags: [math]
---

[Wish upon a shooting star](http://judge.u-aizu.ac.jp/onlinejudge/description.jsp?id=2586)

#### 問題概要

****

3次元空間上のn個の流れ星の初期位置, 速さと向き, 半径, 半径の現象速度が与えられる.  
これらは半径が0になるか, 互いにぶつかると消滅する.  
それぞれの流れ星の消滅するまでの時間を求めよ.

#### 解法

****

幾何要素は皆無.  
2つの星の衝突する時間をtとしてt秒後の位置の距離が半径を足しあわせたものになるので2次方程式を立てる.  
これを解けば衝突するかどうか(判別式), またその時間を求める事ができる.  
方程式は定数項をまとめていくように解くと間違いが少なくなる.  
あとは解から正の時間かつどちらの星も自然消滅していない時間ならその時間を返せば良い.  
  
この衝突時間と自然消滅の時間をイベント時間として列挙してソートする.  
順にみてそのイベントの時間までにどちらの星もまだ消滅していなかったらその時間に消滅したと記録する.  

#### コード

****

{{< includeCode "/AOJ/2586.cpp" "cpp" >}}
