---
layout: post
title: "Codeforces 382D Ksenia and Pawns"
date: 2014-07-09T23:48:00+09:00
comments: true
category: Codeforces
tags: [tree, dfs]
---

[Ksenia and Pawns](http://codeforces.com/contest/382/problem/D)

#### 問題概要

****

盤上に向きが指定されているマスがある.  
コマを2つ置いてそのマスの指示通りに動かす(何も書かれていないマスで止まる).  
向きが指定されているマスには同時に2つのコマは置けず, そうでないマスには置ける.  
移動後に同時に2コマ存在することになる場合はそこで終了.  
2つのコマの位置を決めるとき, 動く回数の総和を最大はいくらになるか. 無限に移動できる場合は-1を出力しろ

#### 解法

****

移動のルートは無限ループを除いて, \'\#\'を根とする木になっている.  
根には2つのコマがきてもいいので, その子の部分木を考える.  
各部分木の高さhを求めれば最長距離がわかり, その木に2つ置く場合はh-1が2番目に長い距離になる(高さhが2つ以上存在する場合でもそれは途中でぶつかる).  
あとはこれを全ての\'\#\'を根とする木について調べて高さの最大2つを取ってくれば良い.

#### コード

****

{{< includeCode "/Codeforces/382D.cpp" "cpp" >}}
