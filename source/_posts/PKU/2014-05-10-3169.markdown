---
layout: post
title: "PKU 3169 Layout"
date: 2014-05-10 16:40:18 +0900
comments: true
category: PKU
tags: [bellman-ford]
---

[Layout](http://poj.org/problem?id=3169)

#### 問題概要

****

仲の良い牛の組とよくない牛の組があり, 仲の良い牛とは一定以上(DL)離れたくないし, 嫌いな牛とは一定以上(DD)離れたい.<br>
また, 牛は番号順に並んでいる.<br>
そのとき1番の牛とN番の牛の距離の最大はいくらか.


#### 解法

****

蟻本初級に載ってるけど絶対初級じゃないよなあ.  
  
条件を式に直す.<br>
牛iと牛j(i < j)が仲がいい時<br>
dist[j] - dist[i] <= DL(i, j)<br>
仲が悪い時<br>
dist[j] - dist[i] >= DD(i, j)<br>
また番号順に並んでいることより<br>
dist[i] <= dist[i+1]<br>

最短路問題において, 有向辺e(i, j)の長さl(i, j)のときその辺に依る距離の関係は<br>
dist[i] + l(i, j) >= dist[j]<br>

このことを利用すると上の条件を以下のように変形してグラフ上の最短路問題に帰着することができる.<br>
仲がいい時: dist[i] + DL(i, j) >= dist[j]<br>
仲が悪い時: dist[j] + (-DD(i, j)) >= dist[i]<br>
番号順: dist[i+1] + 0 >= dist[i]<br>

これにより, N番目の牛までの最短距離が求められる. またこれは配置可能な中でN番目までの距離の最大の値になる.<br>
なぜならDLによってでしか各牛の距離は増加せず, DLは各関係の最大になっているから.<br>
またそのことから, もしそのような辺によって値が更新されないとき, その牛と0番目の牛の距離は無限に大きくできることがわかる.<br>

また負閉路が存在するとき, その閉路によって無限に値が小さくなり, それより前の牛の位置もどんどん小さくなるはず(番号順).<br>
よって0番目の牛の位置が負のとき負閉路が存在する.<br>
負閉路が存在するということは, 距離の関係に矛盾が生じている.<br>
なぜならその区間の増やせる距離の大きさより大きく距離をとっていることになるからである.<br>


#### コード

****

{% include_code PKU/3169.cpp %}

