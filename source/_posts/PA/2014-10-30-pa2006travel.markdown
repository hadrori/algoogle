---
layout: post
title: "PA 2006 Travel Agency"
date: 2014-10-30 22:24:16 +0900
comments: true
category: PA
tags: [max-flow]
---

[Travel Agency](http://main.edu.pl/en/archive/pa/2006/biu)

#### 問題概要

****

n人の客がいる.  
この人達に旅行を手配するとそれぞれ{% m %}x_{i}{% em %}の利益をもたらす(負もある).  
またこれらの人はそれぞれ{% m %}k_{i}{% em %}人と関係があり, {% m %}a_{ij}{% em %}が旅行に行かない場合{% m %}b_{ij}{% em %}の不利益を出す.  
利益を最大にするような客の選び方を求めよ

#### 解法

****

この問題はテストケースをダウンロードして, テストケース番号に応じて埋め込んだ答えを吐くコードを提出しなければならないことに注意すること.  
コードはそのとき使ったコード全てを載せておく.  

* 説明抜きの解法

もたらす利益が非負であるものの総和が利益の上限.  
ここから減る利益を最小化したい.  
頂点sから利益が非負の客に利益をコストとする有向辺を張る.  
利益が負の客から頂点tに利益の絶対値をコストとする有向辺を張る.  
次に客iと関係がある{% m %}a_{ij}{% em %}に{% m %}b_{ij}{% em %}をコストとする有向辺を張る.  
構築したグラフのS-T最小カットが減る利益の最小値, 集合Sが選ぶ客の集合, 集合Tを選ばない客の集合となる.  
  
最小カットは最大流を求めればよく, 最大流を求めた後に集合Sはsから容量が正の辺を辿っていける頂点が選ぶ客になる.  

* なぜうまくいくのか

頂点sから伸びてるのは増える分だけ, また増える分は全て頂点sから伸びてる.  
つまりsから伸びてる辺をカットするとその先の頂点をTに入れるということなので利益がその分減る.  
頂点tに入る辺は不利益をもたらす客からの辺で, 不利益をもたらす客からの辺は全てtに伸びてる.  
この辺をカットするということはその客をSに入れるということなのでその利益がその分減る.  
その他の辺は利益が減る辺で, その辺をカットするということは前の頂点はSに, 後の頂点はTに含まれるということ.  
これはまさに問題の客同士の関係を表している.  
  
どの辺を切っても利益が減ることを表していて, 頂点を2つの集合に分けるような最小のコストを求めることになる.  
つまり最小カットを求めるとよいということになる.  


#### コード

****

{% include_code PA/2006/travel.sh %}

{% include_code PA/2006/travel.cpp %}

{% include_code PA/2006/travel2.cpp %}
