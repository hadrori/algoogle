---
layout: post
title: "PA 2010 Sweets"
date: 2014-11-01 22:15:50 +0900
comments: true
category: PA
tags: [math, line-sweep, geometory]
---

[Sweets](http://main.edu.pl/en/archive/pa/2010/cuk)

#### 問題概要

****

n(<=24)個の箱にそれぞれ{% m %}a_{i}{% em %}個のお菓子がある.  
これを3人兄弟Anton, Dmytro, Borysで箱ごとに配りたい.  
できるだけ平等に分けるとき最小のAntonとBorysのもらう数の差を求めよ.  
ただしそれぞれのもらう数A, D, Bは{% m %} A \geq D \geq B{% em %}を満たさなければならない.

#### 解法

****

まずn個の箱を半分ずつ({% m %}n_{0},n_{1}{% em %})に分ける.  
これは半分ずつ全列挙することで全体で全列挙するのを抑えるため.  
それぞれの集合で3人がもらう数を{% m %}A_{i}, D_{i}, B_{i}{% em %}とする.  
{% m %}(A_{i}, D_{i}, B_{i}){% em %}のありうる組を全列挙しておく.  
列挙した組の集合をそれぞれ{% m %}K_{0}, K_{1}{% em %}とする.  
  
ここで以下のような変換{% m %}K_{i} \rightarrow K'_{i}{% em %}をする.

{% math %}

K_{0} \rightarrow K'_{0}\\
(A_{0}, D_{0}, B_{0}) \in K_{0} \rightarrow (A_{0}-D_{0}, D_{0}-B_{0}) \in K'_{0}\\
\\
K_{1} \rightarrow K'_{1}\\
(A_{1}, D_{1}, B_{1}) \in K_{1} \rightarrow (D_{1}-A_{1}, B_{1}-D_{1}) \in K'_{1}\\

{% endmath %}

これによって求める最小値は{% m %}K'_{0}, K'_{1}{% em %}の要素{% m %}(x_{0},y_{0}), (x_{1},y_{1}){% em %}について

{% math %}

(x_{0}+y_{0})-(x_{1}+y_{1})

{% endmath %}

の最小値となる.  
ただし{% m %}x_{0}\geq x_{1}, y_{0}\geq y_{1}{% em %}を満たす組のみ.  
なぜなら

{% math %}

A_{0}+A_{1} \leq D_{0}+D_{1}\\
A_{0}-D_{0} \leq D_{1}-A_{1}\\
\\
D_{0}+D_{1} \leq B_{0}+B_{1}\\
D_{0}-B_{0} \leq B_{1}-D_{1}\\

{% endmath %}

を満たさなければならないから.  
  
この条件から2次元上の最近点(マンハッタン距離)を求めれば良い.  
条件より{% m %}K'_{0}{% em %}の点を固定してと考えると, 最も近い{% m %}K'_{1}{% em %}の条件を満たす点というのは  
それより左下にあるもののうち, x+yが最大になる点とわかる.  
これは2つの集合の点を混ぜてyの昇順に見ていけば  
{% m %}K'_{0}{% em %}の点pのとき, それまでに出てきた{% m %}K'_{1}{% em %}の点のうちx座標についてp以下にあって, x+yが最大に点が一番近い.  
{% m %}K'_{1}{% em %}の点pのとき, 登場済みリストに入れる. ただしx座標についてそれ以降の点でx+yの値ががp以下のものは選ばれることが無い(もしくはそれを選ぶ必要がない)ので予め削除する.  
  
2つ目の操作から登場済みリストはxについて単調増加であり, またx+yについて単調非減少になる.  
これの性質を利用することで1つ目の操作はx座標についてp以下のもののうち一番近いものを2分探索で選べばよく, 2つ目の操作はx座標についてp以上かつx+yについてp以下の点の区間を2分探索で求め削除することができる.  
  
計算量は列挙に{% m %}O(3^{n/2}) = O(\sqrt{3}^{n}){% em %}, 各操作に{% m %}O(\log \sqrt{3}^{n}){% em %}となる.  
よって全体では{% m %}O(\sqrt(3)^{n}n) = O(1.74^{n}){% em %}となりなんとか間に合う.


#### コード

****

{% include_code PA/2010/sweets.cpp %}
