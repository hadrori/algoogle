---
layout: post
title: "Codeforces 444C DZY Loves Colors"
date: 2014-08-24 21:33:24 +0900
comments: true
category: Codeforces
tags: [segment-tree]
---

[DZY Loves Colors](http://codeforces.com/contest/444/problem/C)

#### 問題概要

****

長さnの帯があり, それは最初位置iの色がiになっている.  
この帯のある場所の色をyからxに変えるとき, その位置の鮮やかさが|y-x|だけ増える.
以下のクエリを実装しろ

1. 区間[l,r]を色xにする

2. 区間[l,r]の鮮やかさの合計を答える

#### 解法

****

以下のようなSegment Treeで実装する. 


* 区間に全体に一度に足された鮮やかさ合計値(add)をもつ
* 区間で足された鮮やかさの合計(sum)をもつ
* 区間の色がすべて同じときの区間の色(col)をもつ
* 区間の色を更新する
* 区間の鮮やかさの合計を答える

区間[l,r)を色xに更新するのは以下のように行う.  

* 現在の区間より上の区間で1色になっていたらその色を現在の区間の色にする
* 現在の区間が更新後とすでに同じ色なら終了
* 現在の区間が完全に更新したい区間に含まれているなら

  - 現在の区間が1色ならその区間に目的の色との差を一気に足す
  - そうでないならさらに区間を下る
  - 現在の区間の色をxにする

* そうでないなら区間の色をｰ1(1色ではない)にして区間を下る
* 最後にその区間で足された鮮やかさの合計をsumに追加する

更新したい区間に完全に含まれているとき\&\&区間の色が1色のときの更新が下の区間に伝播しないのでそこは遅延評価っぽくしている.

#### コード

****

{% include_code Codeforces/444C.cpp %}
