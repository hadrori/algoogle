---
layout: post
title: "AOJ 1169 The Most Powerful Spell"
date: 2015-03-24 17:48:48 +0900
comments: true
category: AOJ
tags: [dp,bellman-ford]
---

[The Most Powerful Spell](http://judge.u-aizu.ac.jp/onlinejudge/description.jsp?id=1169)

#### 問題概要

****

n個の頂点とm個の辺からなるグラフを考える.
各辺にはラベルとして1文字から6文字までの文字列がある.
始点から終点までのパスのラベルを順に繋げたものを呪文という.
辞書順最小の呪文を求めよ.  
ただし終点に到達不可能である場合や任意の呪文に対してそれより小さい呪文が存在する場合は"NO"と出力せよ.

#### 解法

****

とりあえずループする場合は置いておく.  
普通の最短路みたいに始点から順にDPしたら以下の図のような例で死ぬ.  
![aoj1169-01](/images/aoj1169-01.png)  
これを解消するために各頂点に対して長さごとの最小の文字列を持つのが考えられそう.  
しかしよく考えるとある頂点vから終点までの最小の呪文が決まってればどの辺から頂点vに来ればいいのかわかるので辺を逆向きにして終点からDPしてやれば良い.  
dp\[i\] := 頂点iから終点までで追加される呪文の接尾辞の最小

呪文が無限に小さくなるループがある場合について考える.  
ループがないなら呪文を作るパス上の頂点数は高々n.  
各辺は最大6文字のラベルをもつので6n文字以上にはなりえない.  
とりあえずBellman-Fordで7n回ぐらい回して上限を超えるようならNOとすればよい.

#### コード

****

{% include_code AOJ/1169.cpp %}
