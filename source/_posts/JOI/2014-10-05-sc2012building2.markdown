---
layout: post
title: "JOI 春合宿 2012 Building 2"
date: 2014-10-05 02:39:30 +0900
comments: true
category: JOI
tags: [dp]
---

[Building 2](http://joisc2012.contest.atcoder.jp/tasks/joisc2012_building2)

#### 問題概要

****

木の上で最長部分増加列の長さを求めよ.

#### 解法

****

木DP.  

木上での最長部分増加列は以下の3つの場合に分けられる


* 葉から根に向かう方向のパス

* 根から葉に向かう方向のパス

* ある頂点で向きが逆になるパス


これらは根付き木で上る方向に最長部分増加列(LIS), 下る方向に最長部分減少列(LDS)を求めてやればよい.  
LDSは単純に高さを負にしてやれば簡単.  
ある頂点でそれ以下の部分木のLISとLDSを求めれば, その親では子の列をマージしてやればよい(ある長さをとれる最小の値を採用する).  
またその頂点で折れる場合についてはマージ前に試してやる.  
マージには[データ構造をマージする一般的なテク](http://topcoder.g.hatena.ne.jp/iwiwi/20131226/1388062106)を用いること


#### コード

****

{% include_code JOI/2012/building2.cpp %}
