---
layout: post
title: "JOI 春合宿 2009 Sequence"
date: 2014-09-05 03:52:10 +0900
comments: true
category: JOI
tags: [math, implementation]
---

[Sequence](http://joisc2009.contest.atcoder.jp/tasks/joisc2009_sequence)

#### 問題概要

****

m個の要素からなる数列Aが渡される.  
この数列をさらに以下のように拡張するとき, pからqまでにある奇数の数を求めよ.  


{% math %}

A_{i} = A_{i-1}+A_{i-m}

{% endmath %}


#### 解法

まずどの数も偶奇しかいらないので2でmodを取ったものを考える.  
幅mずつ数列をずらしながら区切ってみる.  
サンプルだと始め1234が1010となり次が0101(2345)になる(5=4+1, 下の例は実装を考慮して向きを反転させている).  
この0101から1010は求めることができ(各値について, 一つ前の値と自分の値からm個前の値は一意に定まるから), また当然次の数も求めることが出来る.  
いま幅mが有限なので前後が一意に定まるなら必ずループするはずである.  


```
0101
1010
1101
0110
0011
1001
0100
0010
0001
1000
1100
1110
1111
0111
1011
0101
...

```

よってこのループを求めてやれば区間を圧縮できる.  
ループの長さは最悪でも 2^m-1個のはずである.  
列を求める際にそれまでの奇数の個数をカウントしておけばあとはp,qを圧縮して計算するだけ.

****

#### コード

****

{% include_code JOI/2009/Sequence.cpp %}
