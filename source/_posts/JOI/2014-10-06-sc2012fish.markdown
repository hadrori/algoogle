---
layout: post
title: "JOI 春合宿 2012 Fish"
date: 2014-10-06 00:07:56 +0900
comments: true
category: JOI
tags: [math, inchworm-method]
---

[Fish](http://joisc2012.contest.atcoder.jp/tasks/joisc2012_fish)

#### 問題概要

****

N匹の魚がいる.  
これらは赤, 青, 緑のいずれかの色になっている.  
魚は体長が自分の2倍以上ある魚に食べられてしまうので一緒にできない.  
一緒にできる魚の色の組合せを求めよ

#### 解法

****

setにalgorithmのlower\_boundを使っていてTLE死した.  
  
ある魚に対してそれより小さい魚のうち一緒にいられる魚を考える.  
この時赤がr匹, 青がb匹, 緑がg匹いるとするとその選び方は3辺の長さがr, b, gの直方体の内部の格子点の数に一致する(=3辺がr+1,b+1,g+1の直方体の体積).  
これは赤, 青, 緑の選ぶ数に対して頂点が選べることからわかる.  
この組は魚の体長をソートしておけばしゃくとり法する感じで求められる.  
  
よってそのようなものを全て列挙して, 直方体を重ねあわせた体積を求める問題になる.  
上から下に積分していけば, 各イベント点(各直方体のてっぺん)で長方形の和をとっていくことで断面が求められる.  
各直方体は軸に接するように置いていると考えれば, 断面の長方形の和は各長方形の右上を保存しておけばよい.  
この点列は内部に含まれるものを除けば階段状になっているので, 長方形を追加するときにすぐ下の段(右の段)にくる長方形は2分探索で求められる.  
そこから1つずつ左に見ていき, 高さを積分していくことで増加分の面積を求める.  
すぐ上の段を見つけたら間に今作った新しい段に完全に含まれる段を取り除く.  
  
#### コード

****

{% include_code JOI/2012/fish.cpp %}
